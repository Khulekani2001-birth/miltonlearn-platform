<!doctype html>
<html lang="en" class="h-100">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request Tutor · MiltonLearn</title>
    <meta name="description" content="MiltonLearn is reshaping education through AI-powered personalized tutoring. Experience the future of learning with our innovative educational solutions.">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E4Y24C156P"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
  
      gtag('config', 'G-E4Y24C156P');
    </script>
    <!-- Styles -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="logo.png">
    <link rel="stylesheet" href="css/style.css">
  </head>

<body class="d-flex flex-column">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg sticky-top">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="/index.html">
        <img src="logo.png" alt="MiltonLearn Logo">
        <span class="brand-text">MiltonLearn</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle fw-semibold" href="#" role="button" data-bs-toggle="dropdown">
              <i class="bi bi-grid me-2"></i>Learning Solutions
            </a>
            <ul class="dropdown-menu">
              <li>
                <a class="dropdown-item" href="/request_tutor.html">
                  <i class="bi bi-person-video3 me-2 text-success"></i>
                  <strong>1-on-1 Tutoring</strong><br>
                  <small class="text-muted">Expert human guidance</small>
                </a>
              </li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <a class="dropdown-item" href="https://www.mamtutor.com" target="_blank">
                  <i class="bi bi-robot me-2 text-primary"></i>
                  <strong>MAMTutor AI</strong><br>
                  <small class="text-muted">24/7 AI learning assistant</small>
                </a>
              </li>
              <li>
                <a class="dropdown-item" href="https://examease.miltonlearn.com" target="_blank">
                  <i class="bi bi-journal-check me-2 text-info"></i>
                  <strong>ExamEase</strong><br>
                  <small class="text-muted">Smart exam preparation</small>
                </a>
              </li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link fw-semibold" href="/pricing.html">Pricing</a>
          </li>
          <li class="nav-item">
            <a class="nav-link fw-semibold" href="/shop.html">Shop</a>
          </li>
          <li class="nav-item">
            <a class="nav-link fw-semibold" href="/about.html">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link btn btn-success text-white px-3 ms-2" href="/request_tutor.html">
              <i class="bi bi-person-plus me-1"></i>Get Started
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
    
    <style>
    .dropdown:hover .dropdown-menu {
      display: block;
    }
    
    /* Optional: Add a small delay to prevent accidental triggering */
    .dropdown-menu {
      margin-top: 0;
      transition: all 0.2s;
    }

    /* Enhanced completion tracking styles */
    .completion-indicator {
      background: linear-gradient(135deg, rgba(40, 167, 69, 0.1) 0%, rgba(40, 167, 69, 0.05) 100%);
      border: 1px solid rgba(40, 167, 69, 0.3);
      border-radius: 12px;
      padding: 1.2rem;
      margin-bottom: 1.5rem;
      text-align: center;
    }
    
    .completion-text {
      color: #28a745;
      font-weight: 600;
      margin: 0;
      font-size: 0.95rem;
    }
    
    .field-check {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #28a745;
      font-size: 1.2rem;
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 5;
    }
    
    .field-check.show {
      opacity: 1;
      transform: translateY(-50%) scale(1.1);
    }
    
    .form-group {
      position: relative;
      margin-bottom: 1.5rem;
    }
    
    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    .missing-fields-alert {
      background: linear-gradient(135deg, #fff3cd 0%, #fef9e7 100%);
      border: 1px solid #ffeaa7;
      color: #856404;
      padding: 1rem 1.2rem;
      border-radius: 8px;
      margin-bottom: 1.2rem;
      display: none;
      font-size: 0.9rem;
    }
    
    .missing-fields-alert.show {
      display: block;
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .auto-save {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(40, 167, 69, 0.95);
      color: white;
      padding: 10px 16px;
      border-radius: 25px;
      font-size: 0.85rem;
      font-weight: 500;
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
    }
    
    .auto-save.show {
      opacity: 1;
      transform: translateY(-5px);
    }

    /* Enhanced scroll targeting */
    .form-container {
      scroll-margin-top: 100px;
    }

    /* Subtle form highlight animation */
    @keyframes formHighlight {
      0% { 
        box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.4);
        transform: scale(1);
      }
      50% { 
        box-shadow: 0 0 0 15px rgba(40, 167, 69, 0.1);
        transform: scale(1.002);
      }
      100% { 
        box-shadow: 0 0 0 0 rgba(40, 167, 69, 0);
        transform: scale(1);
      }
    }

    .form-highlight {
      animation: formHighlight 2.5s ease-out;
      border-radius: 15px;
      transition: all 0.3s ease;
    }

    /* Enhanced focus styles */
    .form-control:focus, .form-select:focus {
      border-color: #28a745;
      box-shadow: 0 0 0 0.25rem rgba(40, 167, 69, 0.15);
      transform: translateY(-1px);
      transition: all 0.2s ease;
    }
    
    .form-control, .form-select {
      border-radius: 8px;
      border: 1.5px solid #dee2e6;
      padding: 0.75rem 1rem;
      font-size: 0.95rem;
      transition: all 0.2s ease;
    }
    
    .form-control:hover, .form-select:hover {
      border-color: #28a745;
    }
    
    /* Session info callout */
    .session-info {
      background: linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%);
      border: 1px solid #90caf9;
      border-radius: 12px;
      padding: 1rem 1.25rem;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .session-info i {
      color: #1976d2;
      font-size: 1.5rem;
    }
    
    .session-info-text {
      color: #1565c0;
      font-weight: 500;
      margin: 0;
      font-size: 0.95rem;
    }
    
    /* Optional field styling */
    .optional-label {
      color: #6c757d;
      font-size: 0.85rem;
      font-style: italic;
    }
    
    /* Form sections */
    .form-section {
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid #e9ecef;
    }
    
    .form-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }
    
    .section-title {
      color: #495057;
      font-weight: 600;
      margin-bottom: 1.25rem;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .section-title i {
      color: #28a745;
    }
    </style>

  <section class="py-3">
    <div class="container">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-md-10 form-container" id="tutorFormCard">
            <div class="text-center mb-4">
              <h2>Request Your Tutor</h2>
              <p class="lead">Start your personalized learning journey today</p>
              <p>Need help? Call/WhatsApp <a href="tel:+2687840455">+268 7840 4553</a> or <a href="tel:+27839678191">+27 83 967 8191</a>, or email <a href="mailto:info@miltonlearn.com">info@miltonlearn.com</a>.</p>
              
              <!-- Session info callout -->
              <div class="session-info">
                <i class="bi bi-camera-video"></i>
                <p class="session-info-text">All sessions are conducted live online via Zoom with scheduled appointments. Flexible timing available!</p>
              </div>
              
              <div class="alert alert-info">
                <strong>International Students:</strong> Email <a href="mailto:milton@miltonlearn.com" target="_blank">milton@miltonlearn.com</a> for pricing in your region.
              </div>
            </div>

            <!-- Completion indicator -->
            <div class="completion-indicator">
              <p class="completion-text" id="completionText">Complete the required fields below to submit your request</p>
            </div>
            
            <!-- Missing fields alert -->
            <div class="missing-fields-alert" id="missingFieldsAlert">
              <i class="bi bi-exclamation-triangle me-2"></i><strong>Please complete:</strong> <span id="missingFieldsList"></span>
            </div>

            <form id="tutorForm" class="row g-3 needs-validation" novalidate onsubmit="return false;">
              
              <!-- Contact Information Section -->
              <div class="col-12 form-section">
                <h4 class="section-title">
                  <i class="bi bi-person-circle"></i>Contact Information
                </h4>
                
                <div class="row g-3">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="parentName" class="form-label">Parent/Guardian Full Name <span class="text-danger">*</span></label>
                      <input type="text" class="form-control" id="parentName" name="parentName" required>
                      <i class="bi bi-check-circle-fill field-check" id="parentName-check"></i>
                      <div class="invalid-feedback">
                        Please provide the parent/guardian's full name.
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="studentName" class="form-label">Student Full Name <span class="text-danger">*</span></label>
                      <input type="text" class="form-control" id="studentName" name="studentName" required>
                      <i class="bi bi-check-circle-fill field-check" id="studentName-check"></i>
                      <div class="invalid-feedback">
                        Please provide the student's full name.
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="email" class="form-label">Email Address <span class="text-danger">*</span></label>
                      <input type="email" class="form-control" id="email" name="email" required>
                      <i class="bi bi-check-circle-fill field-check" id="email-check"></i>
                      <div class="invalid-feedback">
                        Please provide a valid email address.
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="parentNumber" class="form-label">Primary Phone Number <span class="text-danger">*</span></label>
                      <input type="tel" class="form-control" id="parentNumber" name="parentNumber" placeholder="Include country code (e.g., +27)" required>
                      <i class="bi bi-check-circle-fill field-check" id="parentNumber-check"></i>
                      <div class="invalid-feedback">
                        Please provide a valid phone number with country code.
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="studentNumber" class="form-label">Student Phone Number <span class="optional-label">(optional)</span></label>
                      <input type="tel" class="form-control" id="studentNumber" name="studentNumber" placeholder="Include country code (e.g., +27)">
                      <i class="bi bi-check-circle-fill field-check" id="studentNumber-check"></i>
                      <div class="invalid-feedback">
                        Please provide a valid phone number with country code.
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="parentOrStudent" class="form-label">Are you the parent or student? <span class="text-danger">*</span></label>
                      <select class="form-select" id="parentOrStudent" name="parentOrStudent" required>
                        <option value="" disabled selected>Select below</option>
                        <option value="Parent">Parent/Guardian</option>
                        <option value="Student">Student</option>
                        <option value="Other">Other (family member, etc.)</option>
                      </select>
                      <i class="bi bi-check-circle-fill field-check" id="parentOrStudent-check"></i>
                      <div class="invalid-feedback">
                        Please select your relationship to the student.
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Academic Information Section -->
              <div class="col-12 form-section">
                <h4 class="section-title">
                  <i class="bi bi-book"></i>Academic Information
                </h4>
                
                <div class="row g-3">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="level" class="form-label">Level of Study <span class="text-danger">*</span></label>
                      <select class="form-select" id="level" name="level" required>
                        <option value="" disabled selected>Select your level of study</option>
                        <option value="Grade 7">Grade 7</option>
                        <option value="Grade 8">Grade 8 / Form 1</option>
                        <option value="Grade 9">Grade 9 / Form 2</option>
                        <option value="Grade 10">Grade 10 / Form 3</option>
                        <option value="Grade 11">Grade 11 / Form 4</option>
                        <option value="Grade 12">Grade 12 / Form 5 / IGCSE / IEB / NSC</option>
                        <option value="AS Level">AS Level</option>
                        <option value="A Level">A Level</option>
                        <option value="Other Grade">Other (specify in additional info)</option>
                      </select>
                      <i class="bi bi-check-circle-fill field-check" id="level-check"></i>
                      <div class="invalid-feedback">
                        Please select your level of study.
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="subject" class="form-label">Subject <span class="text-danger">*</span></label>
                      <select class="form-select" id="subject" name="subject" required>
                        <option value="" disabled selected>Select a subject</option>
                        <option value="Mathematics">Mathematics</option>
                        <option value="Physics">Physics</option>
                        <option value="Chemistry">Chemistry</option>
                        <option value="Computer Science">Computer Science</option>
                      </select>
                      <i class="bi bi-check-circle-fill field-check" id="subject-check"></i>
                      <div class="invalid-feedback">
                        Please select a subject.
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Scheduling Section -->
              <div class="col-12 form-section">
                <h4 class="section-title">
                  <i class="bi bi-calendar-week"></i>Preferred Schedule
                </h4>
                
                <div class="row g-3">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="day" class="form-label">Preferred Day <span class="text-danger">*</span></label>
                      <select class="form-select" id="day" name="day" required>
                        <option value="" disabled selected>Select a day</option>
                        <option value="Monday">Monday</option>
                        <option value="Tuesday">Tuesday</option>
                        <option value="Wednesday">Wednesday</option>
                        <option value="Thursday">Thursday</option>
                        <option value="Friday">Friday</option>
                        <option value="Saturday">Saturday</option>
                        <option value="Sunday">Sunday</option>
                        <option value="Multiple days">Multiple days (flexible)</option>
                      </select>
                      <i class="bi bi-check-circle-fill field-check" id="day-check"></i>
                      <div class="invalid-feedback">
                        Please select your preferred day(s).
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="timePreference" class="form-label">Preferred Time <span class="optional-label">(optional)</span></label>
                      <select class="form-select" id="timePreference" name="timePreference">
                        <option value="" selected>We'll discuss timing together</option>
                        <option value="Morning (8am-12pm)">Morning (8am-12pm)</option>
                        <option value="Afternoon (12pm-5pm)">Afternoon (12pm-5pm)</option>
                        <option value="Evening (5pm-8pm)">Evening (5pm-8pm)</option>
                        <option value="Flexible">Flexible timing</option>
                      </select>
                      <i class="bi bi-check-circle-fill field-check" id="timePreference-check"></i>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Additional Information Section -->
              <div class="col-12 form-section">
                <h4 class="section-title">
                  <i class="bi bi-chat-dots"></i>Additional Information
                </h4>
                
                <div class="form-group">
                  <label for="details" class="form-label">Learning Goals & Special Requirements <span class="optional-label">(optional)</span></label>
                  <textarea class="form-control" id="details" name="details" rows="4" placeholder="Tell us about your learning goals, specific topics you need help with, current challenges, or any special requirements..."></textarea>
                  <div class="form-text">This helps us match you with the perfect tutor and prepare for your first session.</div>
                </div>
              </div>

              <div class="col-12 text-center mt-4">
                <button type="submit" class="btn btn-primary btn-lg px-5" id="submitBtn" disabled>
                  <i class="bi bi-rocket-takeoff me-2"></i>Start My Learning Journey
                </button>
                <div class="mt-2">
                  <small class="text-muted">We'll contact you within 24 hours to discuss pricing and schedule your first session</small>
                </div>
              </div>
            </form>
            <div id="loading" class="spinner-border text-primary mt-3" role="status" style="display: none;">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
        </div>
      </div>
    </br>
  </section>
  
  <!-- Auto-save indicator -->
  <div class="auto-save" id="autoSave">
    <i class="bi bi-cloud-check me-1"></i>Progress saved
  </div>

  <!-- Footer -->
  <footer class="mt-auto">
    <div class="container">
      <div class="row g-4">
        <div class="col-md-6 text-center text-md-start">
          <h5 class="mb-3">Contact Us</h5>
          <p class="mb-2">
            <i class="bi bi-telephone me-2"></i>
            <a href="tel:+26878404553">+268 7840 4553</a>
          </p>
          <p class="mb-0">
            <i class="bi bi-envelope me-2"></i>
            <a href="mailto:info@miltonlearn.com">info@miltonlearn.com</a>
          </p>
        </div>
        <div class="col-md-6 text-center text-md-end">
          <h5 class="mb-3">Follow Us</h5>
          <div class="social-links">
            <a href="https://www.facebook.com/miltonlearn/" target="_blank">
              <i class="bi bi-facebook"></i>
            </a>
            <a href="https://www.instagram.com/miltonlearn/" target="_blank">
              <i class="bi bi-instagram"></i>
            </a>
            <a href="https://www.linkedin.com/company/miltonlearn" target="_blank">
              <i class="bi bi-linkedin"></i>
            </a>
          </div>
        </div>
      </div>
      <hr class="my-4">
      <p class="text-center mb-0">
        © <span id="current-year"></span> MiltonLearn. All rights reserved.
      </p>
    </div>
  </footer>

  <div id="successModal" class="custom-modal">
    <div class="custom-modal-content">
      <span class="custom-modal-close" aria-label="Close modal">&times;</span>
      <div class="success-icon">
        <i class="bi bi-check-circle-fill"></i>
      </div>
      <h2>Request Submitted!</h2>
      <p>Your tutor request has been successfully sent. Our team will contact you within 24 hours to discuss pricing, schedule your first session, and answer any questions.</p>
    </div>
  </div>
  
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- EmailJS -->
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>

  <script>
    // Initialize EmailJS
    (function(){
      emailjs.init("JR2sVi6C36Fta6Ddr");
    })();

    // Set current year in footer and clean URL
    document.addEventListener('DOMContentLoaded', function() {
      const currentYearElement = document.getElementById('current-year');
      if (currentYearElement) {
        currentYearElement.textContent = new Date().getFullYear();
      }

      // Clean URL parameters if they exist
      if (window.location.search) {
        const cleanUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
        window.history.replaceState({}, document.title, cleanUrl);
      }

      // Auto-scroll to form with enhanced targeting
      setTimeout(function() {
        const formContainer = document.getElementById('tutorFormCard');
        const completionIndicator = document.querySelector('.completion-indicator');
        
        if (formContainer) {
          // Add highlight animation class
          formContainer.classList.add('form-highlight');
          
          // Calculate precise scroll position
          const navbarHeight = document.querySelector('.navbar')?.offsetHeight || 70;
          const headerHeight = document.querySelector('.text-center.mb-4')?.offsetHeight || 100;
          const targetElement = completionIndicator || formContainer;
          const targetPosition = targetElement.offsetTop - navbarHeight - 30;
          
          // Smooth scroll with longer duration
          window.scrollTo({
            top: Math.max(0, targetPosition),
            behavior: 'smooth'
          });
          
          // Focus on first input after scroll completes
          setTimeout(function() {
            const firstInput = document.getElementById('parentName');
            if (firstInput) {
              firstInput.focus();
              firstInput.scrollIntoView({ 
                behavior: 'smooth', 
                block: 'center',
                inline: 'nearest'
              });
            }
          }, 1000);
          
          // Remove highlight class after animation
          setTimeout(function() {
            formContainer.classList.remove('form-highlight');
          }, 2500);
        }
      }, 500);
    });

    // Enhanced form completion tracking
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('tutorForm');
      const submitBtn = document.getElementById('submitBtn');
      const completionText = document.getElementById('completionText');
      const missingFieldsAlert = document.getElementById('missingFieldsAlert');
      const missingFieldsList = document.getElementById('missingFieldsList');
      const autoSave = document.getElementById('autoSave');
      
      // Get all required fields
      const requiredFields = form.querySelectorAll('[required]');
      let autoSaveTimeout;
      
      // Check completion status
      function checkCompletion() {
        const completedFields = Array.from(requiredFields).filter(field => {
          return field.value.trim() !== '' && field.checkValidity();
        });
        
        const totalRequired = requiredFields.length;
        const completed = completedFields.length;
        const isComplete = completed === totalRequired;
        
        // Update completion text
        if (isComplete) {
          completionText.innerHTML = `<i class="bi bi-check-circle me-2"></i>All required fields completed! Ready to submit.`;
          completionText.style.color = '#28a745';
          submitBtn.disabled = false;
          missingFieldsAlert.classList.remove('show');
        } else {
          completionText.innerHTML = `<i class="bi bi-hourglass-split me-2"></i>${completed} of ${totalRequired} required fields completed`;
          completionText.style.color = '#856404';
          submitBtn.disabled = true;
          
          // Show missing fields
          const missingFields = Array.from(requiredFields)
            .filter(field => field.value.trim() === '' || !field.checkValidity())
            .map(field => field.previousElementSibling.textContent.replace(' *', ''));
          
          if (completed > 0 && missingFields.length > 0) {
            missingFieldsList.textContent = missingFields.join(', ');
            missingFieldsAlert.classList.add('show');
          }
        }
        
        // Update field check icons (including optional fields that have values)
        const allFields = form.querySelectorAll('input, select, textarea');
        allFields.forEach(field => {
          const checkIcon = document.getElementById(field.id + '-check');
          if (checkIcon) {
            const isRequired = field.hasAttribute('required');
            const hasValue = field.value.trim() !== '';
            const isValid = field.checkValidity();
            
            if (hasValue && isValid) {
              checkIcon.classList.add('show');
            } else {
              checkIcon.classList.remove('show');
            }
          }
        });
      }
      
      // Auto-save function
      function autoSaveProgress() {
        const formData = new FormData(form);
        const data = {};
        for (let [key, value] of formData.entries()) {
          data[key] = value;
        }
        localStorage.setItem('tutorFormData', JSON.stringify(data));
        
        // Show auto-save indicator
        autoSave.classList.add('show');
        setTimeout(() => autoSave.classList.remove('show'), 2000);
      }
      
      // Load saved data
      function loadSavedData() {
        const saved = localStorage.getItem('tutorFormData');
        if (saved) {
          try {
            const data = JSON.parse(saved);
            Object.keys(data).forEach(key => {
              const field = document.getElementById(key);
              if (field && data[key]) {
                field.value = data[key];
              }
            });
            checkCompletion();
          } catch (e) {
            console.error('Error loading saved data:', e);
          }
        }
      }
      
      // Add event listeners to all form fields
      const allFields = form.querySelectorAll('input, select, textarea');
      allFields.forEach(field => {
        field.addEventListener('input', () => {
          checkCompletion();
          
          // Auto-save with debounce
          clearTimeout(autoSaveTimeout);
          autoSaveTimeout = setTimeout(autoSaveProgress, 2000);
        });
        
        field.addEventListener('change', checkCompletion);
      });
      
      // Load saved data on page load
      loadSavedData();
      
      // Initial check
      checkCompletion();
    });

    // Enhanced form validation and submission
    document.addEventListener('DOMContentLoaded', function() {
      'use strict';

      const form = document.getElementById('tutorForm');
      const loadingSpinner = document.getElementById('loading');
      
      if (!form) {
        console.error('Form not found');
        return;
      }

      form.addEventListener('submit', function (event) {
        event.preventDefault();
        event.stopPropagation();
        event.stopImmediatePropagation();
        
        console.log('Form submitted');
        
        if (form.checkValidity()) {
          console.log('Form is valid, sending email...');
          sendEmail();
        } else {
          console.log('Form is invalid');
          form.classList.add('was-validated');
        }
        
        return false;
      }, false);

      function sendEmail() {
        if (loadingSpinner) {
          loadingSpinner.style.display = 'block';
        }
        
        // Get form values
        const templateParams = {
          studentName: document.getElementById('studentName')?.value || '',
          parentName: document.getElementById('parentName')?.value || '',
          reply_to: document.getElementById('email')?.value || '',
          parentNumber: document.getElementById('parentNumber')?.value || '',
          studentNumber: document.getElementById('studentNumber')?.value || 'Not provided',
          day: document.getElementById('day')?.value || '',
          level: document.getElementById('level')?.value || '',
          subject: document.getElementById('subject')?.value || '',
          details: document.getElementById('details')?.value || 'No additional information provided',
          parentOrStudent: document.getElementById('parentOrStudent')?.value || '',
          timePreference: document.getElementById('timePreference')?.value || 'To be discussed',
          meetingLocation: 'Online (Zoom)' // Fixed value since all sessions are online
        };
        
        console.log('Template params:', templateParams);
        
        // Send email using EmailJS
        emailjs.send('service_jytz61d', 'template_kjcid8m', templateParams)
          .then(function(response) {
            console.log('Email sent successfully:', response);
            if (loadingSpinner) {
              loadingSpinner.style.display = 'none';
            }
            showSuccessModal();
            form.reset();
            form.classList.remove('was-validated');
            
            // Clear saved data on successful submission
            localStorage.removeItem('tutorFormData');
            
            // Reset completion tracking
            document.querySelectorAll('.field-check').forEach(check => {
              check.classList.remove('show');
            });
            
            // Reset completion text
            const completionText = document.getElementById('completionText');
            if (completionText) {
              completionText.innerHTML = `<i class="bi bi-hourglass-split me-2"></i>Complete the required fields below to submit your request`;
              completionText.style.color = '#856404';
            }
            
            // Disable submit button
            document.getElementById('submitBtn').disabled = true;
          })
          .catch(function(error) {
            console.error('Request sending failed:', error);
            if (loadingSpinner) {
              loadingSpinner.style.display = 'none';
            }
            alert('Failed to send request. Please try again or contact us directly at info@miltonlearn.com or call +268 7840 4553.');
          });
      }

      // Function to show the success modal
      function showSuccessModal() {
        const modal = document.getElementById('successModal');
        if (modal) {
          modal.style.display = 'block';
        }
      }

      // Close the modal when clicking the close button or outside the modal
      window.onclick = function(event) {
        const modal = document.getElementById('successModal');
        if (modal && (event.target == modal || event.target.className == 'custom-modal-close')) {
          modal.style.display = 'none';
        }
      };
    });
  </script>

  <style>
    /* Success Modal Styles */
    .custom-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      backdrop-filter: blur(5px);
    }

    .custom-modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 2rem;
      border: none;
      border-radius: 15px;
      width: 90%;
      max-width: 500px;
      text-align: center;
      position: relative;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      animation: modalSlideIn 0.3s ease-out;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-50px) scale(0.9);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .custom-modal-close {
      color: #aaa;
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      transition: color 0.3s;
    }

    .custom-modal-close:hover,
    .custom-modal-close:focus {
      color: #28a745;
    }

    .success-icon {
      font-size: 4rem;
      color: #28a745;
      margin-bottom: 1rem;
      animation: successPulse 0.6s ease-out;
    }

    @keyframes successPulse {
      0% {
        transform: scale(0);
      }
      50% {
        transform: scale(1.1);
      }
      100% {
        transform: scale(1);
      }
    }

    .custom-modal h2 {
      color: #28a745;
      margin-bottom: 1rem;
      font-weight: 600;
    }

    .custom-modal p {
      color: #666;
      line-height: 1.6;
      font-size: 1rem;
    }
  </style>
</body>
</html>